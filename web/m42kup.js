var m42kup=function(t){var e={};function r(n){if(e[n])return e[n].exports;var i=e[n]={i:n,l:!1,exports:{}};return t[n].call(i.exports,i,i.exports,r),i.l=!0,i.exports}return r.m=t,r.c=e,r.d=function(t,e,n){r.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:n})},r.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},r.t=function(t,e){if(1&e&&(t=r(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var n=Object.create(null);if(r.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var i in t)r.d(n,i,function(e){return t[e]}.bind(null,i));return n},r.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return r.d(e,"a",e),e},r.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},r.p="",r(r.s=2)}([function(t,e,r){"use strict";function n(){}function i(t){t.prototype=Object.create(n.prototype),Object.defineProperty(t.prototype,"constructor",{value:t,enumerable:!1,writable:!0})}function a(t){if("string"!=typeof t)throw TypeError("text not string");this.text=t}function o({html:t,display:e}){if("string"!=typeof t)throw TypeError("html not string");if(!["inline","leaf-block","container-block"].includes(e))throw TypeError('arg0.display should be one of "inline", "leaf-block", or "container-block".');this.html=t,this.display=e}function s({message:t,code:e}){if("string"!=typeof t)throw TypeError("message not string");if("string"!=typeof e)throw TypeError("code not string");this.message=t,this.code=e}function l({name:t,display:e,render:r,split:n}){if(!t)throw TypeError("You give arg0 a bad name");if(!["inline","leaf-block","container-block"].includes(e))throw TypeError('arg0.display should be one of "inline", "leaf-block", or "container-block".');if(!(r instanceof Function))throw TypeError("arg0.render should be a function");if([this.name,this.display]=[t,e],this.render=((t,e)=>{if(!(t instanceof p))throw TypeError("arg0 should be an instance of m42kup.renderer.Element");return r(t,e)}),void 0!==n){if("string"==typeof n&&(n=[n]),!(n instanceof Array))throw TypeError("arg0.split should be either undefined, a string, or an array");if(!n.length)throw TypeError("arg0.split.length == 0");this.split=n}}function p({name:t,display:e,render:r,code:n,children:i,split:l,options:d}){if(!t)throw TypeError("You give arg0 a bad name");if(!["inline","leaf-block","container-block"].includes(e))throw TypeError('arg0.display should be one of "inline", "leaf-block", or "container-block".');if(!(r instanceof Function))throw TypeError("arg0.render should be a function");if(!n)throw TypeError("You give arg0 a bad code");if((()=>{var t=e=>e instanceof p||e instanceof a||e instanceof s||e instanceof Array&&e.every(t);if(!i.every(t))throw TypeError("All arg0.children should either be an Element, a TextNode, or an ErrorNode")})(),void 0!==l){if("string"==typeof l&&(l=[l]),!(l instanceof Array))throw TypeError("arg0.split should be either undefined, a string, or an array");if(!l.length)throw TypeError("arg0.split.length == 0");this.split=l}var h,c;[this.name,this.display,this.code,this.children]=[t,e,n,i],this.innerIsText=(h=l?l.length:0,(c=((t,e)=>e>0?t.map(t=>c(t,e-1)):t.map(t=>t instanceof a||!(t instanceof s)&&t.outerIsText).every(t=>t)))(i,h)),this.innerText=(()=>{var t=l?l.length:0,e=(t,r,n)=>r>0?t.map((t,i)=>e(t,r-1,n[i])):n?t.map(t=>t instanceof a?t.text:t.outerText).join(""):null;return e(i,t,this.innerIsText)})(),this.innerHtml=(()=>{var t=l?l.length:0,e=(t,r,n,i)=>{if(r>0)return t.map((t,a)=>e(t,r-1,n[a],i[a]));if(n)return i.trim()&&"container-block"==this.display?i.split(/(?:\r\n){2,}|\r{2,}|\n{2,}/).filter(t=>!!t.trim()).map(this.escapeHtml).map(t=>`<p>${t}</p>`).join(""):this.escapeHtml(i);if("container-block"!=this.display)return t.map(t=>t instanceof a?this.escapeHtml(t.text):t instanceof s?'<code class="m42kup-error">'+this.escapeHtml(t.code)+"</code>":t.outerHtml).join("");var o=[],l=[],p=()=>{l.length&&(o.push(l),l=[])},d=t=>l.push(t);return t.forEach(t=>{if(t instanceof a){var e=t.text.split(/(?:\r\n){2,}|\r{2,}|\n{2,}/);if(e.length<2)return void(t.text.trim()&&d(t));e.forEach((t,r)=>{t.trim()&&d(this.text(t)),r<e.length-1&&p()})}else t instanceof s?d(t):"inline"!=t.display?(p(),o.push(t),p()):d(t)}),p(),o.map(t=>t instanceof Array?"<p>"+t.map(t=>t instanceof a?this.escapeHtml(t.text):t instanceof s?'<code class="m42kup-error">'+this.escapeHtml(t.code)+"</code>":t.outerHtml).join("")+"</p>":t.outerHtml).join("")};return e(i,t,this.innerIsText,this.innerText)})();var u=r(this,d);if(this.outerIsText=u instanceof a,this.outerText=this.outerIsText?u.text:null,this.isError=u instanceof s,this.errorMessage=u instanceof s?u.message:null,this.outerIsText)this.outerHtml=this.escapeHtml(this.outerText);else if(u instanceof o)this.outerHtml=u.html;else{if(!(u instanceof s))throw TypeError("Render output should be one of TextNode, HtmlNode, or ErrorNode");this.outerHtml='<code class="m42kup-error">'+this.escapeHtml(u.code)+"</code>"}}i(a),a.prototype.toString=function(){return this.toIndentedString(0)},a.prototype.toIndentedString=function(t){return"\t".repeat(t)+`Text {${JSON.stringify(this.text)}}`},i(o),o.prototype.toString=function(){return this.toIndentedString(0)},o.prototype.toIndentedString=function(t){var e=["display"].map(t=>t+"="+JSON.stringify(this[t])).join(" ");return"\t".repeat(t)+`Html(${e}) {${JSON.stringify(this.html)}}`},i(s),s.prototype.toString=function(){return this.toIndentedString(0)},s.prototype.toIndentedString=function(t){var e=["message","code"].map(t=>t+"="+JSON.stringify(this[t])).join(" ");return"\t".repeat(t)+`Error(${e})`},l.prototype.instantiate=function({code:t,children:e,options:r}){if(!(this instanceof l))throw Error("ElementClass.prototype.instantiate should be called as a method of an ElementClass instance");return new p({name:this.name,display:this.display,render:this.render,code:t,children:e,split:this.split,options:r})},i(p),p.prototype.text=function(t){return new a(t)},p.prototype.html=function(t){return new o({html:t,display:this.display})},p.prototype.error=function(t){return new s({message:t,code:this.code})},p.prototype.toString=function(){return this.toIndentedString(0)},p.prototype.toIndentedString=function(t){var e,r=["display","code","split","isError","errorMessage","innerIsText","innerText","innerHtml","outerIsText","outerText","outerHtml"].map(t=>t+"="+("string"==typeof this[t]||this[t]instanceof Array?JSON.stringify(this[t]):this[t]+"")).join("\n"+"\t".repeat(t+1));return(()=>{var r=(e,n)=>e instanceof Array?e.map(r).join(",\n"):e.toIndentedString(t+1);e=this.children.map(r).join(",\n")})(),"\t".repeat(t)+`Element[${JSON.stringify(this.name)}](\n${"\t".repeat(t+1)}${r}\n${"\t".repeat(t)}) {\n${e}\n${"\t".repeat(t)}}`},p.prototype.escapeHtml=(t=>(t+"").replace(/[&<>"']/g,t=>({"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"})[t])),t.exports={Node:n,TextNode:a,HtmlNode:o,ErrorNode:s,ElementClass:l,Element:p}},function(t,e){function r(t){var e={};for(var r in t)e[r]=t[r];return e}function n(t){var e={};return t.tags&&(e.tags=r(t.tags)),t.hljs&&(e.hljs=t.hljs),t.katex&&(e.katex=t.katex),e}function i(t,e){for(var n in t=r(t),e)t[n]=e[n];return t}t.exports={copyOptions:n,tags:i,options:function(t,e){if("object"!=typeof t||"object"!=typeof e)throw TypeError("One of the options provided is not an object");return t=n(t),e.tags&&(t.tags||(t.tags={}),t.tags=i(t.tags,e.tags)),e.hljs&&(t.hljs=e.hljs),e.katex&&(t.katex=e.katex),t}}},function(t,e,r){var n=r(3),i=r(4),a=r(6),o=r(1),s={};var l={parser:n,renderer:i,highlighter:a,ast2nt:function(t,e){return e||(e={}),e.tags||(e.tags={}),e=o.options(s,e),i.ast2nt(t,e)},render:function(t,e){t+="",e||(e={}),e.tags||(e.tags={}),e=o.options(s,e);var r=n.input2pt(t),a=n.pt2ast(r);return i.ast2nt(a,e).outerHtml},highlight:function(t){t+="";var e=n.input2pt(t);return a.pt2hl(e)},cascade:function(t){if("object"!=typeof t)throw TypeError("typeof options != 'object'");s=o.options(s,t)},set:function(t){if("object"!=typeof t)throw TypeError("typeof options != 'object'");s=t}};t.exports=l},function(t,e){t.exports={input2pt:function(t){var e=[],r=[];function n(e){if("text"==e.type&&r.length&&"text"==r[r.length-1].type){var n=r.pop();e={type:"text",start:n.start,end:e.end,data:n.data+e.data}}if("right boundary marker"==e.type){for(var i=[e];;){if(!(s=r.pop()))throw new Error("No lbm found");if(i.unshift(s),"left boundary marker"==s.type&&s.level==e.level)break}var a=i[0].start,o=i[i.length-1].end;e={type:"element",start:a,end:o,data:t.substring(a,o),children:i}}if("right verbatim marker"==e.type){var s;for(i=[e];;){if(!(s=r.pop()))throw new Error("No lvm found");if(i.unshift(s),"left verbatim marker"==s.type&&s.level==e.level)break}var l=i[0].start,p=i[i.length-1].end;e={type:"verbatim",start:l,end:p,data:t.substring(l,p),children:i}}r.push(e)}for(var i=0;i<t.length;)if("`"==t[i]){var a=i;for(i++;i<t.length&&"<"==t[i];i++);var o=i-a;i<t.length-1&&"."==t[i]&&"<"==t[i+1]&&i++;var s=i;n({type:"left verbatim marker",start:a,end:s,data:t.substring(a,s),level:o}),e.push(-o);var l,p,d=">".repeat(o-1)+"`",h=t.indexOf(d,i),c=h>=0;c&&([l,p]=[h,h+d.length]),i=c?p:t.length,n({type:"text",start:H=s,end:j=c?l:i,data:t.substring(H,j)}),c&&(n({type:"right verbatim marker",start:l,end:p,data:t.substring(l,p),level:p-l}),e.pop())}else if("["==t[i]){var u=i;for(i++;i<t.length&&"<"==t[i];i++);var f=i;if(f-u<(x=e[e.length-1]||0)){n({type:"text",start:u,end:f,data:t.substring(u,f)});continue}e.push(f-u),n({type:"left boundary marker",start:u,end:f,data:t.substring(u,f),level:f-u});var m=i,y=m+t.substring(m).match(/^(?:\!+|\"+|\#+|\$+|\%+|\&+|\'+|\)+|\*+|\++|\,+|\-+|\/+|\;+|\=+|\>+|\?+|\@+|\\+|\^+|\_+|\{+|\|+|\}+|\~+|[a-z][a-z0-9]*(?:\:[a-z][a-z0-9]*)*|)/)[0].length;n({type:"tag name",start:m,end:y,data:t.substring(m,y)});var g=i=y,b=g+t.substring(g).match(/^(?:[.]|)/i)[0].length;n({type:"separator",start:g,end:b,data:t.substring(g,b)}),i=b}else if(">"==t[i]||"]"==t[i]){for(var x=e[e.length-1]||0,v=i;i<t.length&&">"==t[i];i++);var k=i;if(k==t.length||"]"!=t[k]){n({type:"text",start:v,end:k,data:t.substring(v,k)});continue}if(0==x){v<k&&n({type:"text",start:v,end:k,data:t.substring(v,k)});var T=i,w=++i;n({type:"mismatched right boundary marker",start:T,end:w,data:t.substring(T,w)});continue}if(++i-v<x){n({type:"text",start:v,end:i,data:t.substring(v,i)});continue}i-v>x&&n({type:"text",start:v,end:i-x,data:t.substring(v,i-x)});var E=i-x,$=i;n({type:"right boundary marker",start:E,end:$,data:t.substring(E,$),level:$-E}),e.pop()}else{var j,H=i;for(i++;i<t.length&&!["[","]","`",">"].includes(t[i]);i++);n({type:"text",start:H,end:j=i,data:t.substring(H,j)})}for(var N=e.length-1;N>=0;N--){var I=e[N]>0?"right boundary marker":"right verbatim marker",S=e[N]>0?e[N]:-e[N];n({type:I,start:t.length,end:t.length,data:"",level:S})}return r},pt2ast:function(t){return function t(e){return e.map(e=>{switch(e.type){case"text":return{type:"text",text:e.data};case"verbatim":return{type:"text",text:e.children[1].data};case"element":return{type:"element",name:e.children[1].data,code:e.data,children:t(e.children.slice(3,-1))};case"mismatched right boundary marker":return{type:"error",text:e.data};default:throw new TypeError(`Unknown type: ${e.type}`)}}).reduce((t,e,r)=>{if("text"==e.type){if(!e.text)return t;if(r>0&&"text"==t[t.length-1].type)return t[t.length-1].text+=e.text,t}return t.push(e),t},[])}(t)}}},function(t,e,r){var{Node:n,TextNode:i,HtmlNode:a,ErrorNode:o,ElementClass:s,Element:l}=r(0),{Root:p,classMap:d}=r(5),h=r(1);t.exports={ast2nt:function(t,e){e||(e={}),e.tags||(e.tags={});var r=h.tags(d,e.tags);for(var n in r)!1===r[n]&&delete r[n];var a=(t,n)=>{if(n)return p.instantiate({code:"[code unavailable]",children:t.children.map(t=>a(t,!1)),options:e});if("text"==t.type)return new i(t.text);if("error"==t.type)return new o({message:"[error]",code:t.text});if("element"==t.type){if(t.name in r){if(r[t.name].split){var s=(t,e)=>{if(0==e.length)return t.map(t=>a(t,!1));var r,n=e[e.length-1],i=[];(t=t.map(t=>"element"!=t.type||t.name!=n||t.children.length?t:{type:"delimiter"})).length&&"text"==t[0].type&&!t[0].text.trim()&&(t=t.slice(1)),t.length&&"delimiter"==t[0].type||t.unshift({type:"delimiter"});for(var o=0;o<t.length;o++)"delimiter"==t[o].type?(r&&i.push(r),r=[]):r.push(t[o]);return i.push(r),i.map(t=>s(t,e.slice(0,-1)))};return r[t.name].instantiate({code:t.code,children:s(t.children,r[t.name].split),options:e})}return r[t.name].instantiate({code:t.code,children:t.children.map(t=>a(t,!1)),options:e})}return new o({message:t.name?"Undefined tag name":"No tag name",code:t.code})}throw TypeError(t.type)};return a({type:"element",children:t},!0)},Node:n,TextNode:i,HtmlNode:a,ErrorNode:o,ElementClass:s,Element:l}},function(t,e,r){var{TextNode:n,HtmlNode:i,ErrorNode:a,ElementClass:o,Element:s}=r(0),l=new o({name:"[root]",display:"container-block",render:t=>t.html(t.innerHtml)}),p={};p.comment=new o({name:"comment",display:"inline",render:t=>t.text("")}),p.entity=new o({name:"entity",display:"inline",render:t=>t.innerIsText?/^([a-z]{1,50}|#[0-9]{1,10}|#x[0-9a-f]{1,10})$/i.test(t.innerText)?t.html(`&${t.innerText};`):t.error("Invalid value"):t.error("Non-text input")}),["b","code","i","u","sup","sub"].forEach(t=>p[t]=new o({name:t,display:"inline",render:e=>e.html(`<${t}>${e.innerHtml}</${t}>`)})),["h1","h2","h3","h4","h5","h6","p"].forEach(t=>p[t]=new o({name:t,display:"leaf-block",render:e=>e.html(`<${t}>${e.innerHtml}</${t}>`)})),["blockquote"].forEach(t=>p[t]=new o({name:t,display:"container-block",render:e=>e.html(`<${t}>${e.innerHtml}</${t}>`)})),["br"].forEach(t=>p[t]=new o({name:t,display:"inline",render:e=>e.html(`<${t}>${e.innerHtml}`)})),["hr"].forEach(t=>p[t]=new o({name:t,display:"leaf-block",render:e=>e.html(`<${t}>${e.innerHtml}`)})),["ul","ol"].forEach(t=>{p[t]=new o({name:t,display:"container-block",split:"*",render:e=>e.html(`<${t}>`+e.innerHtml.map(t=>`<li>${t}</li>`).join("")+`</${t}>`)})}),p.table=new o({name:"table",display:"container-block",split:["*","**"],render:t=>t.html("<table>"+t.innerHtml.map(t=>"<tr>"+t.map(t=>`<td>${t}</td>`).join("")+"</tr>").join("")+"</table>")}),p.blockcode=new o({name:"blockcode",display:"leaf-block",render:t=>{var e=t.innerHtml.replace(/(^[ \t]*(\r\n|\r|\n))|((\r\n|\r|\n)[ \t]*$)/g,"");return t.html(`<pre><code>${e}\n</code></pre>`)}}),p.bi=new o({name:"bi",display:"inline",render:t=>t.html(`<i><b>${t.innerHtml}</b></i>`)}),p.link=new o({name:"link",display:"inline",render:t=>{if(!t.innerIsText)return t.error("Non-text input");var e=t.innerText;if(/^(http:\/\/|https:\/\/)/.test(e)||(e="http://"+e),!/^(http:\/\/|https:\/\/)[a-z0-9]+(-+[a-z0-9]+)*(\.[a-z0-9]+(-+[a-z0-9]+)*)+\.?(:[0-9]{1,5})?(\/[^ ]*)?$/.test(e))return t.error("Invalid URL");var r=t.escapeHtml(e);return t.html(`<a href="${r}">${r}</a>`)}}),p.img=new o({name:"img",display:"leaf-block",render:t=>{if(!t.innerIsText)return t.error("Non-text input");var e=t.innerText;if(/^(http:\/\/|https:\/\/)/.test(e)||(e="http://"+e),!/^(http:\/\/|https:\/\/)[a-z0-9]+(-+[a-z0-9]+)*(\.[a-z0-9]+(-+[a-z0-9]+)*)+\.?(:[0-9]{1,5})?(\/[^ ]*)?$/.test(e))return t.error("Invalid URL");var r=t.escapeHtml(e);return t.html(`<div class="m42kup-img-block"><img src="${r}"></div>`)}}),["squote","dquote"].forEach(t=>p[t]=new o({name:t,display:"inline",render:e=>{var r={squote:["‘","’"],dquote:["“","”"]};return e.html(`${r[t][0]}${e.innerHtml}${r[t][1]}`)}})),p.highlight=new o({name:"highlight",display:"leaf-block",render:(t,e)=>{if(!e.hljs)return t.error("Element not implemented (options.highlight not given)");if(!t.innerIsText)return t.error("Non-text input");var r=t.innerText.replace(/(^[ \t]*(\r\n|\r|\n))|((\r\n|\r|\n)[ \t]*$)/g,""),n=e.hljs.highlightAuto(r,["apache","bash","coffeescript","cpp","cs","css","diff","http","ini","java","javascript","json","makefile","xml","markdown","nginx","objectivec","perl","php","python","ruby","sql"]).value;return t.html(`<pre class="hljs"><code>${n}\n</code></pre>`)}}),p.math=new o({name:"math",display:"inline",render:(t,e)=>{if(!e.katex)return t.error("Element not implemented (options.katex not given)");if(!t.innerIsText)return t.error("Non-text input");var r=e.katex.renderToString(t.innerText,{throwOnError:!1,displayMode:!1,strict:"error"});return t.html(r)}}),p.displaymath=new o({name:"displaymath",display:"leaf-block",render:(t,e)=>{if(!e.katex)return t.error("Element not implemented (options.katex not given)");if(!t.innerIsText)return t.error("Non-text input");var r=e.katex.renderToString(t.innerText,{throwOnError:!1,displayMode:!0,strict:"error"});return t.html(r)}});var d={'"':"dquote",$:"math",$$:"displaymath","%":"comment","&":"entity","'":"squote","*":"i","**":"b","***":"bi",";":"code",";;":"blockcode",";;;":"highlight","=":"h1","==":"h2","===":"h3","====":"h4","=====":"h5","======":"h6",">":"blockquote","\\":"br","^":"sup",_:"sub","~":"link","~~":"img"};for(var h in d){if(!p[d[h]])throw TypeError("aliasing failed");p[h]=p[d[h]]}t.exports={Root:l,classMap:p}},function(t,e){var r=t=>t.replace(/[&<>"']/g,t=>({"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"})[t]);function n(t){return`<span class="m42kup-hl-${t.type}">${t.html||r(t.text)}</span>`}t.exports={pt2hl:function t(e){for(var r="",i=0;i<e.length;i++)switch(e[i].type){case"text":r+=n({type:"tx",text:e[i].data});break;case"element":var a=n({type:"lbm",text:e[i].children[0].data})+n({type:"tn",text:e[i].children[1].data})+n({type:"sp",text:e[i].children[2].data})+t(e[i].children.slice(3,-1))+n({type:"rbm",text:e[i].children[e[i].children.length-1].data});r+=n({type:"elem",html:a});break;case"verbatim":a=n({type:"lvm",text:e[i].children[0].data})+n({type:"text",text:e[i].children[1].data})+n({type:"rvm",text:e[i].children[2].data}),r+=n({type:"verb",html:a});break;case"mismatched right boundary marker":r+=n({type:"mrbm",text:e[i].data})}return r}}}]);